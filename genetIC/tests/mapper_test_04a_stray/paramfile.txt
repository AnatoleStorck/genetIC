# Test stray particle system when retrieving particle IDs
#
# With strays on, we are allowed to "zoom" beyond the edge of the
# literal zoom grid, but the particles will be interpolated from the
# low-res grid.
#
# The generated sphere of particles has some strange properties.
# In the genuine high-res regions, it should behave identically to
# the normal mode. In the mock-high-res regions, high res particles
# are generated but in "blocks" of 4x4x4 corresponding to the
# underlying low-res grid. This is defined as expected behaviour and
# can be seen in the output. Also, even in the low-res region, the
# particles extend out beyond the defined sphere. This is because the
# high-res flagging now covers the whole simulation domain and then
# gets down-sampled onto the low-res grid. This downsampling procedure
# means high-res cells with centroids that are IN the region map onto low-res cells
# with centroids that may be out. Again, this is defined as accepted
# behaviour and forms part of the test. 


# output parameters
outdir	 ./
outformat tipsy
outname test_11

strays_on

# cosmology:
Om  0.279
Ol  0.721
s8  0.817
zin	99
camb	../camb_transfer_kmax40_z0.dat

# basegrid 50 Mpc/h, 64^3
basegrid 50.0 64

# fourier seeding
seed	8896131



centre 25 25 25
select_sphere 9.0
zoomgrid_with_origin_at 23 23 23 4 64 # zoom grid intentionally too small



centre 17.969 17.969 25 # on corner of true high-res region in x-y plane, roughly in middle of z plane
# this region encompasses true high-res, "stray" high-res, and low-res particles
select_sphere 3.0
dump_idfile output.txt




done
